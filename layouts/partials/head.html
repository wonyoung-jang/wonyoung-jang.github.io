<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

{{- if hugo.IsProduction | or (eq .Site.Params.env "production") }}
    <meta name="robots" content="index, follow">
{{- else }}
    <meta name="robots" content="noindex, nofollow">
{{- end }}

<title>{{ if .IsHome }}{{ else }}{{ if .Title }}{{ .Title }} | {{ end }}{{ end }}{{ site.Title }}</title>

<!-- Meta -->
{{- if .IsHome }}
{{ with site.Params.keywords -}}<meta name="keywords" content="{{- range $i, $e := . }}{{ if $i }}, {{ end }}{{ $e }}{{ end }}">{{ end }}
{{- else }}
<meta name="keywords" content="{{ if .Params.keywords -}}
    {{- range $i, $e := .Params.keywords }}{{ if $i }}, {{ end }}{{ $e }}{{ end }} {{- else }}
    {{- range $i, $e := .Params.tags }}{{ if $i }}, {{ end }}{{ $e }}{{ end }} {{- end -}}">
{{- end }}
<meta name="description" content="{{- with .Description }}{{ . }}{{- else }}{{- if or .IsPage .IsSection}}
    {{- .Summary | default (printf "%s - %s" .Title  site.Title) }}{{- else }}
    {{- with site.Params.description }}{{ . }}{{- end }}{{- end }}{{- end -}}">
    
<meta name="author" content="{{ (partial "author.html" . ) }}">

<link rel="canonical" href="{{ if .Params.canonicalURL -}} {{ trim .Params.canonicalURL " " }} {{- else -}} {{ .Permalink }} {{- end }}" />

{{- if .Site.Params.analytics.google.SiteVerificationTag }}
    <meta name="google-site-verification" content="{{ .Site.Params.analytics.google.SiteVerificationTag }}" />
{{- end }}

{{- if .Site.Params.analytics.yandex.SiteVerificationTag }}
    <meta name="yandex-verification" content="{{ .Site.Params.analytics.yandex.SiteVerificationTag }}" />
{{- end }}

{{- if .Site.Params.analytics.bing.SiteVerificationTag }}
    <meta name="msvalidate.01" content="{{ .Site.Params.analytics.bing.SiteVerificationTag }}" />
{{- end }}

{{- if site.Params.analytics.naver.SiteVerificationTag }}
    <meta name="naver-site-verification" content="{{ site.Params.analytics.naver.SiteVerificationTag }}">
{{- end }}

<!-- Styles -->
{{- $reset              := (resources.Match "css/00-reset/*.css")       | resources.Concat "assets/css/00-reset.css" }}
{{- $reference          := (resources.Match "css/01-reference/*.css")   | resources.Concat "assets/css/01-reference.css" }}
{{- $system             := (resources.Match "css/02-system/*.css")      | resources.Concat "assets/css/02-system.css" }}
{{- $base               := (resources.Match "css/03-base/*.css")        | resources.Concat "assets/css/03-base.css" }}
{{- $layout             := (resources.Match "css/04-layout/*.css")      | resources.Concat "assets/css/04-layout.css" }}
{{- $component          := (resources.Match "css/05-component/*.css")   | resources.Concat "assets/css/05-component.css" }}
{{- $custom             := (resources.Match "css/06-custom/*.css")      | resources.Concat "assets/css/06-custom.css" }}
{{- $page               := (resources.Match "css/07-page/*.css")        | resources.Concat "assets/css/07-page.css" }}
{{- $theme              := (resources.Match "css/08-theme/*.css")       | resources.Concat "assets/css/08-theme.css" }}
{{- $stylesheet := (slice $reset $reference $system $base $layout $component $custom $page $theme) | resources.Concat "assets/css/stylesheet.css" | resources.Minify }}

{{- with .Site.Params.profileMode }}
    {{- if and .enabled .imageUrl $.IsHome }}
        <link rel="preload" href="{{ .imageUrl }}" as="image">
    {{- end }}
{{- end }}

{{- with .Site.Params.label.icon }}
    <link rel="preload" href="{{ . }}" as="image">
{{- end }}

{{- if not site.Params.assets.disableFingerprinting }}
{{- $stylesheet := $stylesheet | fingerprint }}
    <link crossorigin="anonymous" href="{{ $stylesheet.RelPermalink }}" integrity="{{ $stylesheet.Data.Integrity }}" rel="preload stylesheet" as="style">
{{- else }}
    <link crossorigin="anonymous" href="{{ $stylesheet.RelPermalink }}" rel="preload stylesheet" as="style">
{{- end }}

<!-- Search -->
{{- if (eq .Layout `search`) -}}
    <link crossorigin="anonymous" rel="preload" as="fetch" href="../index.json">
    {{- $fastsearch := resources.Get "js/fastsearch.js" | js.Build (dict "params" (dict "fuseOpts" site.Params.fuseOpts)) | resources.Minify }}
    {{- $fusejs := resources.Get "js/fuse.js" }}
    {{- if not site.Params.assets.disableFingerprinting }}
        {{- $search := (slice $fusejs $fastsearch ) | resources.Concat "assets/js/search.js" | fingerprint }}
        <script defer crossorigin="anonymous" src="{{ $search.RelPermalink }}" integrity="{{ $search.Data.Integrity }}"></script>
    {{- else }}
        {{- $search := (slice $fusejs $fastsearch ) | resources.Concat "assets/js/search.js" }}
        <script defer crossorigin="anonymous" src="{{ $search.RelPermalink }}"></script>
    {{- end }}
{{- end -}}

<!-- Favicons -->
<link rel="icon" href="{{ .Site.Params.assets.favicon | default "favicon.ico" | absURL }}">
<link rel="icon" type="image/png" sizes="16x16" href="{{ .Site.Params.assets.favicon16x16 | default "favicon-16x16.webp" | absURL }}">
<link rel="icon" type="image/png" sizes="32x32" href="{{ .Site.Params.assets.favicon32x32 | default "favicon-32x32.webp" | absURL }}">
<link rel="apple-touch-icon" href="{{ .Site.Params.assets.apple_touch_icon | default "apple-touch-icon.webp" | absURL }}">
<link rel="mask-icon" href="{{ .Site.Params.assets.safari_pinned_tab | default "safari-pinned-tab.webp" | absURL }}">
<meta name="theme-color" content="{{ .Site.Params.assets.theme_color | default "#2e2e33" }}">
<meta name="msapplication-TileColor" content="{{ .Site.Params.assets.msapplication_TileColor | default "#2e2e33" }}">

<!-- Generator -->
{{ hugo.Generator }}

<!-- RSS -->
{{ range .AlternativeOutputFormats -}}
    <link rel="{{ .Rel }}" type="{{ .MediaType.Type | html }}" href="{{ .Permalink | safeURL }}">
{{ end -}}

{{- range .AllTranslations -}}
    <link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}">
{{ end -}}

<!-- No script styles -->
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }
    </style>

    {{- if (and (ne .Site.Params.defaultTheme "light") (ne .Site.Params.defaultTheme "dark")) }}
        <style>
            @media (prefers-color-scheme: dark) {
                :root {
                    --theme: rgb(29, 30, 32);
                    --entry: rgb(46, 46, 51);
                    --primary: rgb(218, 218, 219);
                    --secondary: rgb(155, 156, 157);
                    --tertiary: rgb(65, 66, 68);
                    --content: rgb(196, 196, 197);
                    --code-block-bg: rgb(46, 46, 51);
                    --code-bg: rgb(55, 56, 62);
                    --border: rgb(51, 51, 51);
                }

                .list {
                    background: var(--theme);
                }

                .list:not(.dark)::-webkit-scrollbar-track {
                    background: 0 0;
                }

                .list:not(.dark)::-webkit-scrollbar-thumb {
                    border-color: var(--theme);
                }
            }
        </style>
    {{- end }}
</noscript>

<!-- Misc -->
{{- if hugo.IsProduction | or (eq .Site.Params.env "production") }}
    {{- template "_internal/google_analytics.html" . }}
    {{- template "partials/templates/opengraph.html" . }}
    {{- template "partials/templates/twitter_cards.html" . }}
    {{- template "partials/templates/schema_json.html" . }}
{{- end -}}
