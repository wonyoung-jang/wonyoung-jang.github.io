<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
{{- if hugo.IsProduction | or (eq site.Params.env "production") | and (ne .Params.robotsNoIndex true) }}
    <meta name="robots" content="index, follow">
{{- else }}
    <meta name="robots" content="noindex, nofollow">
{{- end }}

{{/* Meta */}}
<meta name="description" content="{{- with .Description -}}{{- . -}}{{- else -}}{{- if or .IsPage .IsSection -}}{{- .Summary | default (printf "%s - %s" .Title  site.Title) -}}{{- else -}}{{- with site.Params.description -}}{{- . -}}{{- end -}}{{- end -}}{{- end }}">
<meta name="author" content="Wonyoung Jang">
{{- if site.Config.Services.GoogleAnalytics.ID }}
    <meta name="google-site-verification" content="{{ site.Config.Services.GoogleAnalytics.ID }}">
{{- end }}

<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

{{/* Title */}}
<title>
    {{ if .IsHome }}
        {{ site.Title }}
    {{ else }}
        {{ .Title }} | {{ site.Title }}
    {{ end }}
</title>

{{- partialCached "fonts.html" . -}}

{{/* Styles */}}
{{- $cssFiles := dict
    "base"       (resources.Match "css/base/**.css")
    "components" (resources.Match "css/material_components/**.css")
    "custom"     (resources.Match "css/custom_custom/**.css")
    "layouts"    (resources.Match "css/material_layouts/**.css")
    "helpers"    (resources.Match "css/custom_helpers/**.css")
-}}
  
{{- $stylesheets := dict
    "1base"                    (slice "base")
    "2material_design"         (slice "layouts" "components")
    "3custom"                  (slice "custom")
    "4helpers"                 (slice "helpers")
-}}
  
{{- range $name, $parts := $stylesheets }}
    {{- $files := slice }}

    {{- range $parts }}
        {{- $files = $files | append (index $cssFiles .) }}
    {{- end }}

    {{- $combined := $files | resources.Concat (printf "assets/css/%s.css" $name) | resources.Minify | fingerprint }}

    <link crossorigin="anonymous" href="{{ $combined.RelPermalink }}" integrity="{{ $combined.Data.Integrity }}" rel="preload stylesheet" as="style">
{{- end }}

{{/* Search */}}
{{ if (eq .Layout `search`) }}
    <link rel="preload" as="fetch" href="../index.json" crossorigin="anonymous">
    {{ $fastsearch := resources.Get "js/fastsearch.js" | js.Build (dict "params" (dict "fuseOpts" site.Params.fuseOpts)) }}
    {{ $fusejs := resources.Get "js/fuse.js" }}
    {{ $search := (slice $fusejs $fastsearch ) | resources.Concat "assets/js/search.js" | resources.Minify | fingerprint }}
    <script defer crossorigin="anonymous" src="{{ $search.RelPermalink }}" integrity="{{ $search.Data.Integrity }}"></script>
{{ end }}

{{/* Favicons */}}
<link rel="icon" href="{{ site.Params.assets.favicon | default "sitelogo.svg" | absURL }}">

{{/* RSS */}}
{{ range .AlternativeOutputFormats }}
    <link rel="{{ .Rel }}" type="{{ .MediaType.Type | html }}" href="{{ .Permalink | safeURL }}">
{{ end }}

{{ range .AllTranslations }}
    <link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}">
{{ end }}

{{/* Generator */}}
{{ hugo.Generator }}

<noscript>
    <style>
        #theme-toggle,
        #top-link {
            display: none;
        }
    </style>
</noscript>

{{/* Misc */}}
{{ template "_internal/opengraph.html" . }}
{{ template "_internal/schema.html" . }}
{{ template "_internal/twitter_cards.html" . }}
