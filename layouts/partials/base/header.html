{{/* Top App Bar */}}
<nav class="component top-app-bar center small" aria-label="Top App Bar">
    <!-- Site Headline -->
    <section class="start">
        <!-- Site ID -->
        {{ partial "components/siteid-button.html" . }}
        
        <!-- Site Headline -->
        <a  id="site-headline"
            class="title-medium"
            href="{{ "" | absLangURL }}">
            Wonyoung Jang
        </a>
    </section>

    <!-- Buttons -->
    <section class="end">
        <!-- Language switch -->
        {{- $lang := .Lang}}
        {{- with $.Site.Home.AllTranslations }}
            <ul class="lang-switch">
                {{- range . -}}
                    {{- if ne $lang .Lang }}
                        <a  href="{{- .Permalink -}}" 
                            title="{{ .Language.Params.languageAltTitle | default (.Language.LanguageName | emojify) | default (.Lang | title) }}"
                            aria-label="{{ .Language.LanguageName | default (.Lang | title) }}">
                            
                            {{- if (and $.Site.Params.displayFullLangName (.Language.LanguageName)) }}
                                {{- .Language.LanguageName | emojify -}}
                            {{- else }}
                                {{- .Lang | title -}}
                            {{- end -}}

                        </a>
                    {{- end -}}
                {{- end}}
            </ul>
        {{- end }}

        <!-- Theme toggle -->
        {{ partial "components/theme-button.html" . }}        
        
        <!-- Random page -->
        {{ partial "components/random-button.html" . }}
        
        <!-- Search-->
        {{ partial "components/search-button.html" . }}
    </section>
</nav>

<!-- Tabs -->
<div class="component tabs title-medium">
    {{ define "menu-item" }}   
        {{ $page := .page }}
        {{ with .entry }}
            {{ if .HasChildren }}
                {{ if or ($page.IsMenuCurrent "main" .) ($page.HasMenuCurrent "main" .) }}
                    <a  class="component tab active"
                        href="{{ .URL }}">

                        {{ .Name }}

                        <section class="sub-menu">
                            {{ range .Children }}
                                {{ template "menu-item" (dict "entry" . "page" $page) }}
                            {{ end }}
                        </section>
                    </a>
                {{ else }}
                    <a  class="component tab"
                        href="{{ .URL }}">

                        {{ .Name }}
                        
                        <section class="sub-menu">
                            {{ range .Children }}
                                {{ template "menu-item" (dict "entry" . "page" $page) }}
                            {{ end }}
                        </section>
                    </a>
                {{ end }}
            {{ else }}
                {{ if $page.IsMenuCurrent "main" . }}
                    <a class="component tab active"
                        href="{{ .URL }}">
                        {{ .Name }}
                    </a>
                {{ else }}
                    <a class="component tab" 
                        href="{{ .URL }}">
                        {{ .Name }}
                    </a>
                {{ end }}
            {{ end }}
        {{ end }}
    {{ end }}
    
    <div class="component tabs">
        {{ $page := . }}
        {{ range .Site.Menus.main }}
            {{ template "menu-item" (dict "entry" . "page" $page) }}
        {{ end }}
    </div>
</div>

<!-- Light -->
{{- if (eq .Site.Params.defaultTheme "light") }}
    <script>
        if (localStorage.getItem("pref-theme") === "dark") {
            document.body.classList.add('dark');
        }
    </script>
<!-- Dark -->
{{- else if (eq .Site.Params.defaultTheme "dark") }}
    <script>
        if (localStorage.getItem("pref-theme") === "light") {
            document.body.classList.remove('dark')
        }
    </script>
<!-- Auto -->
{{- else }}
    <script>
        if (localStorage.getItem("pref-theme") === "dark") {
            document.body.classList.add('dark');
        } else if (localStorage.getItem("pref-theme") === "light") {
            document.body.classList.remove('dark')
        } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.body.classList.add('dark');
        }
    </script>
{{- end }}
