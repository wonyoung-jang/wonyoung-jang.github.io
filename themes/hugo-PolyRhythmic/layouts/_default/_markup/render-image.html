{{ $isCoverImage := not (.Page.Scratch.Get "coverImage") }}

{{- if .IsBlock -}}
  <figure
    {{- if $isCoverImage }} 
      class="cover-image"
    {{ end }}>
    
    <img
      src="{{ .Destination | safeURL }}"
      {{- with .Text }}
        alt="{{ . }}"
      {{ end -}}>

    <figcaption>{{ .Title }}</figcaption>

  </figure>
{{- else -}}
  <img
    src="{{ .Destination | safeURL }}"
    {{- with .Text }}
      alt="{{ . }}"
    {{ end -}}

    {{- with .Title }}
      title="{{ . }}"
    {{ end -}}

    {{- if $isCoverImage }} 
      class="cover-image"
    {{ end -}}>
{{- end -}}

{{ if $isCoverImage }}
  {{ .Page.Scratch.Set "coverImage" true }}
{{ end }}
